#include <algorithm>
#include <iostream>
#include "text.hh"
#include "utils.hh"
#include "globals.hh"

using namespace std;
using namespace pro2;
    
string Text::stoi(int n) {
        if (n != 0) {
            string word;
            while (n > 0) {
                char digit = '0' + n % 10;
                word.push_back(digit);
                n /= 10;
            }
            int k = word.size();
            std::reverse(word.begin(), word.end());
            return word;
        }
        return "0";
    }

void Text::paint_char(pro2::Window& window, Pt pos, const char c, Color col) const {
    if (c >= '0' and c <= '9') {
        int idx = c - '0';
        paint_sprite(window, pos, numbers_[idx], col);
    }
    else if (c >= 'a' and c <= 'z') {
        int idx = c - 'a';
        paint_sprite(window, pos, alphabet_[idx], col);
    }
    else if (c >= 'A' and c <= 'Z')  {
        int idx = c - 'A';
        paint_sprite(window, pos, alphabet_[idx], col);
    }
    else std::cout << "Error: unknown character to draw";
}

void Text::paint_phrase(pro2::Window& window, Pt pos, const string word, Color col) const {
    int n = word.size();
    for (int i = 0; i < n; ++i) {
        if (word[i] != ' ') {
            paint_char(window, pos, word[i], col);
        }
        pos.x += FONT_SIZE;
    }
}


void Text::paint_number(pro2::Window& window, Pt pos, const int n, Color col) const {
    paint_phrase(window, pos, stoi(n), col);
}

//Sprites of the alphabet

const int _ = -1;
const int o = -2; // 

const vector<Sprite> Text::alphabet_ = {
    // A (0)
    {
        {_, _, o, o, o, _, _, _},
        {_, o, o, _, o, o, _, _},
        {o, o, _, _, _, o, o, _},
        {o, o, _, _, _, o, o, _},
        {o, o, o, o, o, o, o, _},
        {o, o, _, _, _, o, o, _},
        {o, o, _, _, _, o, o, _},
        {_, _, _, _, _, _, _, _},
    },
    // B (1)
    {
        {o, o, o, o, o, o, _, _},
        {o, o, _, _, _, o, o, _},
        {o, o, _, _, _, o, o, _},
        {o, o, o, o, o, o, _, _},
        {o, o, _, _, _, o, o, _},
        {o, o, _, _, _, o, o, _},
        {o, o, o, o, o, o, _, _},
        {_, _, _, _, _, _, _, _},
    },
    // C (2)
    {
        {_, _, o, o, o, o, _, _},
        {_, o, o, _, _, o, o, _},
        {o, o, _, _, _, _, _, _},
        {o, o, _, _, _, _, _, _},
        {o, o, _, _, _, _, _, _},
        {_, o, o, _, _, o, o, _},
        {_, _, o, o, o, o, _, _},
        {_, _, _, _, _, _, _, _},
    },
    // D (3)
    {
        {o, o, o, o, o, _, _, _},
        {o, o, _, _, o, o, _, _},
        {o, o, _, _, _, o, o, _},
        {o, o, _, _, _, o, o, _},
        {o, o, _, _, _, o, o, _},
        {o, o, _, _, o, o, _, _},
        {o, o, o, o, o, _, _, _},
        {_, _, _, _, _, _, _, _},
    },
    // E (4)
    {
        {o, o, o, o, o, o, o, _},
        {o, o, _, _, _, _, _, _},
        {o, o, _, _, _, _, _, _},
        {o, o, o, o, o, o, _, _},
        {o, o, _, _, _, _, _, _},
        {o, o, _, _, _, _, _, _},
        {o, o, o, o, o, o, o, _},
        {_, _, _, _, _, _, _, _},
    },
    // F (5)
    {
        {o, o, o, o, o, o, o, _},
        {o, o, _, _, _, _, _, _},
        {o, o, _, _, _, _, _, _},
        {o, o, o, o, o, o, _, _},
        {o, o, _, _, _, _, _, _},
        {o, o, _, _, _, _, _, _},
        {o, o, _, _, _, _, _, _},
        {_, _, _, _, _, _, _, _},
    },
    // G (6)
    {
        {_, _, o, o, o, o, o, _},
        {_, o, o, _, _, _, _, _},
        {o, o, _, _, _, _, _, _},
        {o, o, _, o, o, o, o, _},
        {o, o, _, _, _, o, o, _},
        {_, o, o, _, _, o, o, _},
        {_, _, o, o, o, o, o, _},
        {_, _, _, _, _, _, _, _},
    },
    // H (7)
    {
        {o, o, _, _, _, o, o, _},
        {o, o, _, _, _, o, o, _},
        {o, o, _, _, _, o, o, _},
        {o, o, o, o, o, o, o, _},
        {o, o, _, _, _, o, o, _},
        {o, o, _, _, _, o, o, _},
        {o, o, _, _, _, o, o, _},
        {_, _, _, _, _, _, _, _},
    },
    // I (8)
    {
        {_, o, o, o, o, o, o, _},
        {_, _, _, o, o, _, _, _},
        {_, _, _, o, o, _, _, _},
        {_, _, _, o, o, _, _, _},
        {_, _, _, o, o, _, _, _},
        {_, _, _, o, o, _, _, _},
        {_, o, o, o, o, o, o, _},
        {_, _, _, _, _, _, _, _},
    },
    // J (9)
    {
        {_, _, _, o, o, o, o, _},
        {_, _, _, _, _, o, o, _},
        {_, _, _, _, _, o, o, _},
        {_, _, _, _, _, o, o, _},
        {o, o, _, _, _, o, o, _},
        {o, o, _, _, _, o, o, _},
        {_, o, o, o, o, o, _, _},
        {_, _, _, _, _, _, _, _},
    },
    // K (10)
    {
        {o, o, _, _, _, o, o, _},
        {o, o, _, _, o, o, _, _},
        {o, o, _, o, o, _, _, _},
        {o, o, o, o, _, _, _, _},
        {o, o, o, o, o, _, _, _},
        {o, o, _, o, o, o, _, _},
        {o, o, _, _, o, o, o, _},
        {_, _, _, _, _, _, _, _},
    },
    // L (11)
    {
        {_, o, o, _, _, _, _, _},
        {_, o, o, _, _, _, _, _},
        {_, o, o, _, _, _, _, _},
        {_, o, o, _, _, _, _, _},
        {_, o, o, _, _, _, _, _},
        {_, o, o, _, _, _, _, _},
        {_, o, o, o, o, o, o, _},
        {_, _, _, _, _, _, _, _},
    },
    // M (12)
    {
        {o, o, _, _, _, o, o, _},
        {o, o, o, _, o, o, o, _},
        {o, o, o, o, o, o, o, _},
        {o, o, o, o, o, o, o, _},
        {o, o, _, o, _, o, o, _},
        {o, o, _, _, _, o, o, _},
        {o, o, _, _, _, o, o, _},
        {_, _, _, _, _, _, _, _},
    },
    // N (13)
    {
        {o, o, _, _, _, o, o, _},
        {o, o, o, _, _, o, o, _},
        {o, o, o, o, _, o, o, _},
        {o, o, o, o, o, o, o, _},
        {o, o, _, o, o, o, o, _},
        {o, o, _, _, o, o, o, _},
        {o, o, _, _, _, o, o, _},
        {_, _, _, _, _, _, _, _},
    },
    // O (14)
    {
        {_, o, o, o, o, o, _, _},
        {o, o, _, _, _, o, o, _},
        {o, o, _, _, _, o, o, _},
        {o, o, _, _, _, o, o, _},
        {o, o, _, _, _, o, o, _},
        {o, o, _, _, _, o, o, _},
        {_, o, o, o, o, o, _, _},
        {_, _, _, _, _, _, _, _},
    },
    // P (15)
    {
        {o, o, o, o, o, o, _, _},
        {o, o, _, _, _, o, o, _},
        {o, o, _, _, _, o, o, _},
        {o, o, _, _, _, o, o, _},
        {o, o, o, o, o, o, _, _},
        {o, o, _, _, _, _, _, _},
        {o, o, _, _, _, _, _, _},
        {_, _, _, _, _, _, _, _},
    },
    // Q (16)
    {
        {_, o, o, o, o, o, _, _},
        {o, o, _, _, _, o, o, _},
        {o, o, _, _, _, o, o, _},
        {o, o, _, _, _, o, o, _},
        {o, o, _, o, o, o, o, _},
        {o, o, _, _, o, o, _, _},
        {_, o, o, o, o, _, o, _},
        {_, _, _, _, _, _, _, _},
    },
    // R (17)
    {
        {o, o, o, o, o, o, _, _},
        {o, o, _, _, _, o, o, _},
        {o, o, _, _, _, o, o, _},
        {o, o, _, _, o, o, o, _},
        {o, o, o, o, o, _, _, _},
        {o, o, _, o, o, o, _, _},
        {o, o, _, _, o, o, o, _},
        {_, _, _, _, _, _, _, _},
    },
    // S (18)
    {
        {_, o, o, o, o, _, _, _},
        {o, o, _, _, o, o, _, _},
        {o, o, _, _, _, _, _, _},
        {_, o, o, o, o, o, _, _},
        {_, _, _, _, _, o, o, _},
        {o, o, _, _, _, o, o, _},
        {_, o, o, o, o, o, _, _},
        {_, _, _, _, _, _, _, _},
    },
    // T (19)
    {
        {o, o, o, o, o, o, o, _},
        {_, _, _, o, o, _, _, _},
        {_, _, _, o, o, _, _, _},
        {_, _, _, o, o, _, _, _},
        {_, _, _, o, o, _, _, _},
        {_, _, _, o, o, _, _, _},
        {_, _, _, o, o, _, _, _},
        {_, _, _, _, _, _, _, _},
    },
    // U (20)
    {
        {o, o, _, _, _, o, o, _},
        {o, o, _, _, _, o, o, _},
        {o, o, _, _, _, o, o, _},
        {o, o, _, _, _, o, o, _},
        {o, o, _, _, _, o, o, _},
        {o, o, _, _, _, o, o, _},
        {_, o, o, o, o, o, _, _},
        {_, _, _, _, _, _, _, _},
    },
    // V (21)
    {
        {o, o, _, _, _, o, o, _},
        {o, o, _, _, _, o, o, _},
        {o, o, _, _, _, o, o, _},
        {o, o, o, _, o, o, o, _},
        {_, o, o, o, o, o, _, _},
        {_, _, o, o, o, _, _, _},
        {_, _, _, o, _, _, _, _},
        {_, _, _, _, _, _, _, _},
    },
    // W (22)
    {
        {o, o, _, _, _, o, o, _},
        {o, o, _, _, _, o, o, _},
        {o, o, _, o, _, o, o, _},
        {o, o, o, o, o, o, o, _},
        {o, o, o, o, o, o, o, _},
        {o, o, o, _, o, o, o, _},
        {o, o, _, _, _, o, o, _},
        {_, _, _, _, _, _, _, _},
    },
    // X (23)
    {
        {o, o, _, _, _, o, o, _},
        {o, o, o, _, o, o, o, _},
        {_, o, o, o, o, o, _, _},
        {_, _, o, o, o, _, _, _},
        {_, o, o, o, o, o, _, _},
        {o, o, o, _, o, o, o, _},
        {o, o, _, _, _, o, o, _},
        {_, _, _, _, _, _, _, _},
    },
    // Y (24)
    {
        {_, o, o, _, _, o, o, _},
        {_, o, o, _, _, o, o, _},
        {_, o, o, _, _, o, o, _},
        {_, _, o, o, o, o, _, _},
        {_, _, _, o, o, _, _, _},
        {_, _, _, o, o, _, _, _},
        {_, _, _, o, o, _, _, _},
        {_, _, _, _, _, _, _, _},
    },
    // Z (25)
    {
        {o, o, o, o, o, o, o, _},
        {_, _, _, _, o, o, o, _},
        {_, _, _, o, o, o, _, _},
        {_, _, o, o, o, _, _, _},
        {_, o, o, o, _, _, _, _},
        {o, o, o, _, _, _, _, _},
        {o, o, o, o, o, o, o, _},
        {_, _, _, _, _, _, _, _},
    }
};

const vector<Sprite> Text::numbers_ = {
    // 0 (26)
    {
        {_, _, o, o, o, _, _, _},
        {_, o, _, _, o, o, _, _},
        {o, o, _, _, _, o, o, _},
        {o, o, _, _, _, o, o, _},
        {o, o, _, _, _, o, o, _},
        {_, o, o, _, _, o, _, _},
        {_, _, o, o, o, _, _, _},
        {_, _, _, _, _, _, _, _},
    },
    // 1 (27)
    {
        {_, _, _, o, o, _, _, _},
        {_, _, o, o, o, _, _, _},
        {_, _, _, o, o, _, _, _},
        {_, _, _, o, o, _, _, _},
        {_, _, _, o, o, _, _, _},
        {_, _, _, o, o, _, _, _},
        {o, o, o, o, o, o, o, _},
        {_, _, _, _, _, _, _, _},
    },
    // 2 (28)
    {
        {_, o, o, o, o, o, _, _},
        {o, o, _, _, _, o, o, _},
        {_, _, _, _, o, o, o, _},
        {_, _, o, o, o, o, _, _},
        {_, o, o, o, o, _, _, _},
        {o, o, o, _, _, _, _, _},
        {o, o, o, o, o, o, o, _},
        {_, _, _, _, _, _, _, _},
    },
    // 3 (29)
    {
        {_, o, o, o, o, o, o, _},
        {_, _, _, _, o, o, _, _},
        {_, _, _, o, o, _, _, _},
        {_, _, o, o, o, o, _, _},
        {_, _, _, _, _, o, o, _},
        {o, o, _, _, _, o, o, _},
        {_, o, o, o, o, o, _, _},
        {_, _, _, _, _, _, _, _},
    },
    // 4 (30)
    {
        {_, _, _, o, o, o, _, _},
        {_, _, o, o, o, o, _, _},
        {_, o, o, _, o, o, _, _},
        {o, o, _, _, o, o, _, _},
        {o, o, o, o, o, o, o, _},
        {_, _, _, _, o, o, _, _},
        {_, _, _, _, o, o, _, _},
        {_, _, _, _, _, _, _, _},
    },
    // 5 (31)
    {
        {o, o, o, o, o, o, _, _},
        {o, o, _, _, _, _, _, _},
        {o, o, o, o, o, o, _, _},
        {_, _, _, _, _, o, o, _},
        {_, _, _, _, _, o, o, _},
        {o, o, _, _, _, o, o, _},
        {_, o, o, o, o, o, _, _},
        {_, _, _, _, _, _, _, _},
    },
    // 6 (32)
    {
        {_, _, o, o, o, o, _, _},
        {_, o, o, _, _, _, _, _},
        {o, o, _, _, _, _, _, _},
        {o, o, o, o, o, o, _, _},
        {o, o, _, _, _, o, o, _},
        {o, o, _, _, _, o, o, _},
        {_, o, o, o, o, o, _, _},
        {_, _, _, _, _, _, _, _},
    },
    // 7 (33)
    {
        {o, o, o, o, o, o, o, _},
        {o, o, _, _, _, o, o, _},
        {_, _, _, _, o, o, _, _},
        {_, _, _, o, o, _, _, _},
        {_, _, o, o, _, _, _, _},
        {_, _, o, o, _, _, _, _},
        {_, _, o, o, _, _, _, _},
        {_, _, _, _, _, _, _, _},
    },
    // 8 (34)
    {
        {_, o, o, o, o, o, _, _},
        {o, o, _, _, _, o, o, _},
        {o, o, _, _, _, o, o, _},
        {_, o, o, o, o, o, _, _},
        {o, o, _, _, _, o, o, _},
        {o, o, _, _, _, o, o, _},
        {_, o, o, o, o, o, _, _},
        {_, _, _, _, _, _, _, _},
    },
    // 9 (35)
    {
        {_, o, o, o, o, o, _, _},
        {o, o, _, _, _, o, o, _},
        {o, o, _, _, _, o, o, _},
        {_, o, o, o, o, o, o, _},
        {_, _, _, _, _, o, o, _},
        {_, _, _, _, o, o, _, _},
        {_, o, o, o, o, _, _, _},
        {_, _, _, _, _, _, _, _},
    }
};